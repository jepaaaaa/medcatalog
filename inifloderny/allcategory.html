<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Semua Kategori - MedCatalog</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="assets/css/allcategorycss.css" />
</head>
<body>
  <?php include 'auth_check.php'; ?>
  <header>
     <nav class="navbar">
      <div class="logo">MedCatalog</div>
      <ul class="nav-links">
        <li><a href="home.html">Home</a></li>
        <li><a href="allcategory.html">Products</a></li>
        <li><a href="index.html">Contact</a></li>
      </ul>
    </nav>

  </header>
  <main>
    <section class="kategori">

    <div class="produk-unggulan">
      <h3>Produk Unggulan</h3>
      <div class="produk-list">
        <article class="produk-item">
          <div class="produk-info">
            <h4>Nama Produk</h4>
            <p>A subheading for this section, as long or as short as you like</p>
            <div class="produk-buttons">
              <button class="buy-btn">Buy</button>
              <button class="consult-btn">Consultation</button>
            </div>
            <p class="price">$10.99</p>
          </div>
          <img src="https://i.ibb.co/ZxW5kWJ/watermelon.png" alt="Watermelon" />
        </article>

        <article class="produk-item produk-alt">
          <img src="https://i.ibb.co/2sKGbPj/pears.png" alt="Pears" />
          <div class="produk-info">
            <h4>Nama Produk</h4>
            <p>A subheading for this section, as long or as short as you like</p>
            <p class="price">$10.99</p>
            <div class="produk-buttons">
              <button class="buy-btn">Buy</button>
              <button class="consult-btn">Consultation</button>
            </div>
          </div>
        </article>

        <article class="produk-item">
          <div class="produk-info">
            <h4>Nama Produk</h4>
            <p>A subheading for this section, as long or as short as you like</p>
            <div class="produk-buttons">
              <button class="buy-btn">Buy</button>
              <button class="consult-btn">Consultation</button>
            </div>
          </div>
          <img src="https://i.ibb.co/ZxW5kWJ/watermelon.png" alt="Watermelon" />
        </article>

        <article class="produk-item produk-alt">
          <img src="https://i.ibb.co/2sKGbPj/pears.png" alt="Pears" />
          <div class="produk-info">
            <h4>Nama Produk</h4>
            <p>A subheading for this section, as long or as short as you like</p>
            <p class="price">$10.99</p>
            <div class="produk-buttons">
              <button class="buy-btn">Buy</button>
              <button class="consult-btn">Consultation</button>
            </div>
          </div>
        </article>
      </div>
    </div>

    <div class="kategori-lainnya">
      <h3>Kategori Lainnya</h3>
      <div class="kategori-grid">
        <article class="kategori-item tall">
          <img src="https://i.ibb.co/qYyfR8M/pear.png" alt="Pear" />
          <p><strong>Nama Kategori</strong> - Nama Produk</p>
          <p>Sub heading with description in one or two clappings line</p>
          <p class="price">$10.99</p>
        </article>
        <article class="kategori-item">
          <img src="https://i.ibb.co/2sKGbPj/pears.png" alt="Pears" />
          <p><strong>Nama Kategori</strong> - Nama Produk</p>
          <p>Sub heading with description in one or two clappings line</p>
          <p class="price">$15.99</p>
        </article>
        <article class="kategori-item">
          <img src="https://i.ibb.co/C69Z4sS/mushroom.png" alt="Mushroom" />
          <p><strong>Nama Kategori</strong> - Nama Produk</p>
          <p>Sub heading with description in one or two clappings line</p>
          <p class="price">$12.99</p>
        </article>
    </div>
  </section>
  </main>
  <footer>
    <div class="footer-top">
      <div class="footer-site-name">MedCatalog</div>
      <div class="footer-links">
        <div class="footer-topic">
          <strong>Produk</strong>
          <a href="home.html">Katalog</a>
          <a href="allcategory.html">Kategori</a>
          <a href="index.html">Tentang</a>
        </div>
        <div class="footer-topic">
          <strong>Bantuan</strong>
          <a href="#">FAQ</a>
          <a href="#">Kontak</a>
          <a href="#">Dukungan</a>
        </div>
        <div class="footer-topic">
          <strong>Ikuti Kami</strong>
          <a href="#">Facebook</a>
          <a href="#">Twitter</a>
          <a href="#">Instagram</a>
        </div>
      </div>
    </div>
    <div class="footer-social">
      <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
      <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
      <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
      <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
      <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
    </div>
    <p>Â© 2025 MedCatalog. Semua hak dilindungi. Konsultasikan dengan dokter sebelum menggunakan obat.</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const findUsLink = document.getElementById("findUsLink");
      if (findUsLink) {
        findUsLink.addEventListener("click", function () {
          window.location.href = "index.html";
        });
      }

      // Fungsi untuk mengambil data produk dari database
      async function fetchProducts() {
        try {
          const response = await fetch('get_products.php');
          const data = await response.json();
          return data.products || [];
        } catch (error) {
          console.error('Error fetching products:', error);
          return [];
        }
      }

      // Fungsi untuk membuat kartu produk
      function createProductCard(product, index) {
        const isAlt = index % 2 === 1; // Alternate layout setiap produk kedua
        const cardClass = isAlt ? 'produk-item produk-alt' : 'produk-item';

        // Handle image URL - jika path relatif, tambahkan base URL
        let imageUrl = product.image_url;
        if (imageUrl && !imageUrl.startsWith('http')) {
          imageUrl = window.location.origin + '/' + imageUrl;
        }
        if (!imageUrl) {
          imageUrl = 'https://via.placeholder.com/200x150?text=No+Image';
        }

        let cardHTML = '';

        if (isAlt) {
          // Gambar di kiri, info di kanan
          cardHTML = `
            <article class="${cardClass}">
              <img src="${imageUrl}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/200x150?text=No+Image'" />
              <div class="produk-info">
                <h4>${product.name}</h4>
                <p>${product.description || 'Deskripsi produk tidak tersedia'}</p>
                <p class="price">Rp ${Math.floor(Math.random() * 50000) + 10000}</p>
                <div class="produk-buttons">
                  <button class="buy-btn">Beli</button>
                  <button class="consult-btn">Konsultasi</button>
                </div>
              </div>
            </article>
          `;
        } else {
          // Info di kiri, gambar di kanan
          cardHTML = `
            <article class="${cardClass}">
              <div class="produk-info">
                <h4>${product.name}</h4>
                <p>${product.description || 'Deskripsi produk tidak tersedia'}</p>
                <div class="produk-buttons">
                  <button class="buy-btn">Beli</button>
                  <button class="consult-btn">Konsultasi</button>
                </div>
                <p class="price">Rp ${Math.floor(Math.random() * 50000) + 10000}</p>
              </div>
              <img src="${imageUrl}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/200x150?text=No+Image'" />
            </article>
          `;
        }

        return cardHTML;
      }

      // Fungsi untuk render produk
      async function renderProducts() {
        const products = await fetchProducts();
        const produkList = document.querySelector('.produk-list');

        if (!produkList) {
          console.error('Element .produk-list tidak ditemukan');
          return;
        }

        if (products.length === 0) {
          produkList.innerHTML = '<p>Tidak ada produk tersedia saat ini.</p>';
          return;
        }

        // Kosongkan konten statis dan isi dengan data dinamis
        produkList.innerHTML = '';

        products.forEach((product, index) => {
          const productCard = createProductCard(product, index);
          produkList.innerHTML += productCard;
        });

        // Tambahkan event listener untuk tombol setelah render
        addButtonListeners();
      }

      // Fungsi untuk menambahkan event listener ke tombol
      function addButtonListeners() {
        // Event listener untuk tombol Beli
        document.querySelectorAll('.buy-btn').forEach(button => {
          button.addEventListener('click', function() {
            const productName = this.closest('.produk-info').querySelector('h4').textContent;
            alert(`Produk "${productName}" telah ditambahkan ke keranjang!`);
          });
        });

        // Event listener untuk tombol Konsultasi
        document.querySelectorAll('.consult-btn').forEach(button => {
          button.addEventListener('click', function() {
            const productName = this.closest('.produk-info').querySelector('h4').textContent;
            alert(`Konsultasi untuk produk "${productName}" akan dihubungkan dengan dokter kami.`);
          });
        });
      }

      // Panggil fungsi render produk saat halaman dimuat
      renderProducts();
    });
  </script>
</body>
</html>