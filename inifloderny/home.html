<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luka Plus</title>
  <link rel="stylesheet" href="homecss.css" />
</head>
<body>
  <?php include 'auth_check.php'; ?>

  <header>
    <nav class="navbar">
      <div class="logo">MedCatalog</div>
      <ul class="nav-links">
        <li><a href="#">Home</a></li>
        <span id="Categoryy" class="find-us-text">Categories</span>
        <span id="findUsLink" class="find-us-text">Contact</span>
        <li><a href="logout.php" class="logout-link" onclick="return confirm('Apakah Anda yakin ingin logout?')">Logout</a></li>
      </ul>
    </nav>
    <section class="hero">
      <h1>E-Catalog Obat Terpercaya</h1>
      <p>Temukan obat berkualitas dengan informasi lengkap dan harga terbaik untuk kesehatan Anda.</p>
      <div class="search-container">
        <input type="text" placeholder="Cari obat berdasarkan nama..." id="search-input">
        <button type="button" id="search-btn">ğŸ”</button>
      </div>
    </section>
  </header>

  <main>
    <section class="product-section">
      <h2>Product</h2>
      
      <div class="products" id="products-container">
        </div>

    </section>

Â  Â  <section class="rating-section">
Â  Â  Â  <h2>Rating</h2>

Â  Â  Â  <ul class="ratings-list">
Â  Â  Â  Â  <li>
Â  Â  Â  Â  Â  <h4>5/5 sangat membantu</h4>
Â  Â  Â  Â  Â  <p>sangat membantu karena bisa mengetahui deskripsi dan harga</p>
Â  Â  Â  Â  </li>
Â  Â  Â  Â  <li>
Â  Â  Â  Â  Â  <h4>tampilan yang menarik dan mudah</h4>
Â  Â  Â  Â  Â  <p>mudah digunakan apalagi anak gen z yang memiliki keingintahuan tinggi</p>
Â  Â  Â  Â  </li>
Â  Â  Â  Â  <li>
Â  Â  Â  Â  Â  <h4>99% Customer Satisfaction</h4>
Â  Â  Â  Â  Â  <p>bisa memberikan rekomendasi.</p>
Â  Â  Â  Â  </li>
Â  Â  Â  </ul>
Â  Â  </section>

Â  Â  <section class="consultation-section">
Â  Â  Â  <h2>Consultation</h2>
Â  Â  Â  <form class="consultation-form">
Â  Â  Â  Â  <div class="form-row">
Â  Â  Â  Â  Â  <label for="name">Name</label>
Â  Â  Â  Â  Â  <input type="text" id="name" name="name" autocomplete="off" />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="form-row">
Â  Â  Â  Â  Â  <label for="email">Email</label>
Â  Â  Â  Â  Â  <input type="email" id="email" name="email" autocomplete="off" />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="form-row">
Â  Â  Â  Â  Â  <label for="phone">Phone</label>
Â  Â  Â  Â  Â  <input type="tel" id="phone" name="phone" autocomplete="off" />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="form-row">
Â  Â  Â  Â  Â  <label for="date">Preferred Date</label>
Â  Â  Â  Â  Â  <input type="date" id="date" name="date" />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="consult-buttons">
Â  Â  Â  Â  Â  <button type="submit" class="btn-primary">Send</button>
Â  Â  Â  Â  Â  <button type="reset" class="btn-secondary">Cancel</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </form>
Â  Â  </section>
  </main>

  <footer>
    <p>Â© 2025 MedCatalog. Semua hak dilindungi. Konsultasikan dengan dokter sebelum menggunakan obat.</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const productsContainer = document.getElementById("products-container");

      function renderProducts(products) {
        productsContainer.innerHTML = ""; // clear
        if (!products || products.length === 0) {
          productsContainer.innerHTML = "<p>Tidak ada produk ditemukan.</p>";
          return;
        }
        products.forEach(product => {
          const productCard = document.createElement("article");
          productCard.className = "product-card";
          productCard.innerHTML = `
            <img src="${product.image_url}" alt="${product.name}" />
            <div class="card-content">
              <h3>${product.name}</h3>
              <span class="category">Kategori: ${product.category || 'Umum'}</span>
              <p class="description">${product.description}</p>
              <div class="details">
                <span class="price">Rp ${product.price || '25.000'}</span>
                <span class="stock">Stok: ${product.stock || 'Tersedia'}</span>
              </div>
              <div class="actions">
                <button class="btn-detail" data-id="${product.id}">Detail</button>
                <button class="btn-add-cart" data-id="${product.id}">Tambah ke Keranjang</button>
              </div>
            </div>
          `;
          productsContainer.appendChild(productCard);
        });

        // Add event listeners for buttons
        document.querySelectorAll('.btn-detail').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const productId = e.target.dataset.id;
            window.location.href = `product.html?id=${productId}`;
          });
        });

        document.querySelectorAll('.btn-add-cart').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const productId = e.target.dataset.id;
            // Simple cart functionality - you can enhance this
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const existingItem = cart.find(item => item.id == productId);
            if (existingItem) {
              existingItem.quantity = (existingItem.quantity || 1) + 1;
            } else {
              cart.push({ id: productId, quantity: 1 });
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            alert('Produk ditambahkan ke keranjang!');
          });
        });
      }

      function fetchJson(url) {
        return fetch(url).then(response => {
          if (!response.ok) throw new Error('HTTP ' + response.status + ' for ' + url);
          return response.json();
        });
      }

      // Coba endpoint PHP dulu, kalau gagal fallback ke products.json
      fetchJson('get_products.php')
        .then(data => {
          // Jika ada error dari server
          if (data.error) {
            throw new Error(data.error);
          }
          renderProducts(data.products);
          setupSearch(data.products); // Setup search setelah load produk
        })
        .catch(err => {
          console.warn('get_products.php failed:', err);
          // Fallback ke static JSON (untuk development tanpa DB)
          fetchJson('products.json')
            .then(products => {
              renderProducts(products);
              setupSearch(products);
            })
            .catch(err2 => {
              console.error('Fallback products.json failed:', err2);
              productsContainer.innerHTML = "<p>Gagal memuat produk. Silakan coba lagi nanti.</p>";
            });
        });

      // Setup search functionality
      function setupSearch(products) {
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');

        function filterProducts(query) {
          const filtered = products.filter(product =>
            product.name.toLowerCase().includes(query.toLowerCase()) ||
            product.description.toLowerCase().includes(query.toLowerCase())
          );
          renderProducts(filtered);
        }

        searchInput.addEventListener('input', (e) => {
          filterProducts(e.target.value);
        });

        searchBtn.addEventListener('click', () => {
          filterProducts(searchInput.value);
        });

        searchInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            filterProducts(searchInput.value);
          }
        });
      }
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const findUsLink = document.getElementById("findUsLink");
      if (findUsLink) {
        findUsLink.addEventListener("click", function () {
          window.location.href = "index.html"; // Seharusnya ini mengarah ke section, bukan reload halaman
        });
      }

      const categoryLink = document.getElementById("Categoryy");
      if (categoryLink) {
        categoryLink.addEventListener("click", function () {
          window.location.href = "allcategory.html";
        });
      }
    });
  </script>

  <footer>
    <div class="footer-top">
      <div class="footer-site-name">MedCatalog</div>
      <div class="footer-links">
        <div class="footer-topic">
          <strong>Produk</strong>
          <a href="home.html">Katalog</a>
          <a href="allcategory.html">Kategori</a>
          <a href="index.html">Tentang</a>
        </div>
        <div class="footer-topic">
          <strong>Bantuan</strong>
          <a href="#">FAQ</a>
          <a href="#">Kontak</a>
          <a href="#">Dukungan</a>
        </div>
        <div class="footer-topic">
          <strong>Ikuti Kami</strong>
          <a href="#">Facebook</a>
          <a href="#">Twitter</a>
          <a href="#">Instagram</a>
        </div>
      </div>
    </div>
    <div class="footer-social">
      <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
      <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
      <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
      <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
      <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
    </div>
    <p>Â© 2025 MedCatalog. Semua hak dilindungi. Konsultasikan dengan dokter sebelum menggunakan obat.</p>
  </footer>

</body>
</html>